import{j as p,r as Bn}from"./index-7s7xaQU8.js";import{r as e}from"./index-CC6F48bw.js";import{C as qn,p as Sn,I as bn,Q as Me,J as wt,g as Ye,K as zn,N as ie,R as fe,X as Un,u as Wt,s as _n,Y as Wn,Z as Kn,k as ut,G as vn,_ as Cn,$ as kn,V as Jn,a0 as Qn,a1 as Yn,a2 as Gn,a3 as $t,a4 as Xn,a5 as Zn,a6 as er,a7 as tr}from"./month-view-DIKko5XM.js";var gt;(function(s){s.Circular="Circular",s.Cupertino="Cupertino",s.SingleCircle="SingleCircle",s.DoubleCircle="DoubleCircle"})(gt||(gt={}));const Kt=e.forwardRef((s,i)=>{const{className:t,label:n="",visible:l=!0,thickness:r="3px",animationDuration:o="1s",color:x=qn.Primary,size:h="36px",overlay:M=!1,type:C=gt.Circular,children:g,...m}=s,H=e.useRef(null);e.useEffect(()=>{Sn("spinner")},[]);const y=36,E=e.useMemo(()=>({label:n,visible:l,thickness:r,animationDuration:o,color:x,size:h,overlay:M,type:C}),[n,l,r,o,x,h,M,C]);e.useImperativeHandle(i,()=>({...E,element:H.current}),[E]);const _=({thickness:V,duration:R})=>e.useMemo(()=>{const P=(y-V)/2,B=2*Math.PI*P;return p.jsx("svg",{viewBox:`0 0 ${y} ${y}`,children:p.jsx("circle",{cx:y/2,cy:y/2,r:(y-V)/2,strokeWidth:V,strokeDasharray:B,strokeDashoffset:B*.25,strokeLinecap:"round",fill:"none",className:"sf-spinner-circle-inner",style:{animation:`spinner-rotate ${R} linear infinite`}})})},[V,R,y]),J=({duration:V,thickness:R})=>{const Q=e.useMemo(()=>{const B=y/2-y*.1,Y=R,z=y*.15,de=360/12;return Array.from({length:12},(xe,je)=>{const Te=de*je,ce=(je+1)/12;return p.jsx("line",{x1:y/2,y1:y/2-B,x2:y/2,y2:y/2-B+z,className:"sf-spinner-cupertino-dots-inner",strokeWidth:Y,strokeLinecap:"round",opacity:ce,transform:`rotate(${Te} ${y/2} ${y/2})`},je)})},[R]);return p.jsx("svg",{viewBox:`0 0 ${y} ${y}`,className:"sf-spinner-cupertino-dots",style:{animation:`spinner-rotate ${V} linear infinite`},children:Q})},W=({thickness:V,duration:R})=>{const{outerCircleRadius:Q,innerCircleRadius:P,outerDashLength:B,innerDashLength:Y}=e.useMemo(()=>{const z=(y-V)/2,de=(y-V*5)/2,xe=2*Math.PI*z,je=2*Math.PI*de,Te=4,ce=xe/(Te*2),F=je/(Te*2);return{outerCircleRadius:z,innerCircleRadius:de,outerDashLength:ce,innerDashLength:F}},[V,y]);return p.jsxs(p.Fragment,{children:[p.jsx("svg",{viewBox:`0 0 ${y} ${y}`,className:"sf-spinner-doublecircle-inner",children:p.jsx("circle",{cx:y/2,cy:y/2,r:Q,strokeWidth:V,fill:"none",strokeDasharray:`${B} ${B}`,strokeLinecap:"round",style:{animation:`spinner-dash ${R} linear infinite`}})}),p.jsx("svg",{viewBox:`0 0 ${y} ${y}`,className:"sf-spinner-doublecircle-second-inner",children:p.jsx("circle",{cx:y/2,cy:y/2,r:P,strokeWidth:Math.max(1,V-1),fill:"none",strokeDasharray:`${Y} ${Y}`,strokeLinecap:"round",style:{animation:`spinner-dash ${R} linear infinite`}})})]})},K=({thickness:V,duration:R})=>e.useMemo(()=>{const P=(y-V)/2,z=2*Math.PI*P/(8*2);return p.jsx("svg",{viewBox:`0 0 ${y} ${y}`,children:p.jsx("circle",{cx:y/2,cy:y/2,r:P,strokeWidth:V,fill:"none",className:"sf-spinner-singlecircle-inner",strokeDasharray:`${z} ${z}`,strokeLinecap:"round",style:{animation:`spinner-rotate ${R} linear infinite`}})})},[V,R]),N=V=>{if(typeof V!="string")return"1s";const R=["ms","s"];for(const Q of R)if(V.endsWith(Q)){const P=V.slice(0,-Q.length),B=parseFloat(P);if(!isNaN(B))return`${B}${Q}`}return"1s"},S=x,d=Math.max(1,parseFloat(r)||3),u=e.useMemo(()=>N(o),[o]),v=e.useMemo(()=>{if(g!=null)return g;switch(C){case gt.Cupertino:return p.jsx(J,{thickness:d,duration:u});case gt.DoubleCircle:return p.jsx(W,{thickness:d,duration:u});case gt.SingleCircle:return p.jsx(K,{thickness:d,duration:u});case gt.Circular:default:return p.jsx(_,{thickness:d,duration:u})}},[g,C,S,d,u]),a=bn(h),j=e.useMemo(()=>({width:a,height:a}),[a]),L=e.useMemo(()=>`sf-spinner${M?" sf-spinner-overlay":""} sf-control${t?" "+t:""} sf-spinner-${String(x).toLowerCase()}`,[M,t,x]),D=e.useMemo(()=>C===gt.DoubleCircle&&!g?"sf-spinner-doublecircle":"",[C,g]);return l?p.jsx("div",{ref:H,className:L,"aria-live":"polite",role:"status",...m,children:p.jsxs("div",{className:"sf-content-center sf-spinner-content ",children:[p.jsx("span",{className:D,style:j,children:v}),n?p.jsx("div",{className:"sf-spinner-label",children:n}):null]})}):null});Kt.displayName="Spinner";var _t;(function(s){s.Left="Left",s.Right="Right"})(_t||(_t={}));function nr(s,i,t=wt.None){const n=[],l=zn({},Jt,i);if(l.groupBy){let r=new Me().group(String(l.groupBy));r=In(t,"key",r),wn(s,r).forEach(x=>{const h={};h[String(l.text)]=x.key,h.isHeader=!0;let M=String(l.text);M==="id"&&(M="text",Object.assign(h,{text:x.key})),h[String(l.id)]=`group-list-item-${x.key?x.key.toString().trim():"undefined"}`,h.items=x.items,n.push(h),n.push(...x.items)})}return n}function In(s,i,t=new Me){const n=t instanceof Me?t:new Me;return s==="Ascending"?n.sortBy(i,"ascending",!0):s==="Descending"?n.sortBy(i,"descending",!0):n.queries&&(n.queries=n.queries.filter(l=>l.fn!=="onSortBy")),n}function wn(s,i){return!s||!i?[]:new Ye(s).executeLocal(i)}function rr(s,i){const t={};if(ie(s))return s;if(typeof s=="string"||typeof s=="number"||typeof s=="boolean"){const n=s.toString();return t[i.text||"text"]=n,t[i.id||"id"]=s,t}else if(ie(s.isHeader)){for(const n of Object.keys(i))if(Object.prototype.hasOwnProperty.call(i,n)){const l=i[n],r=!ie(l)&&typeof l=="string"?fe(l,s):void 0;!ie(r)&&typeof l=="string"&&l.trim()&&(t[String(l)]=r)}if(!i.text&&i.id&&!ie(fe(i.id,s))){const n=i.id,l=fe(n,s);t.text=l}}else return s;return t}const sr=s=>{if(!s)return 40;const i=s.querySelector(".sf-list-item"),t=i?i.offsetHeight:0;return typeof t=="number"&&t>0?t:40},or=(s,i)=>i?i.querySelector(`.sf-list-item[data-index="${s}"]`):null,Ft=(s,i)=>{!i||ie(s)||requestAnimationFrame(()=>{var n;const t=or(s,i);if(t)(n=t==null?void 0:t.scrollIntoView)==null||n.call(t,{block:"nearest",inline:"nearest"});else{const l=sr(i);i.scrollTop=s*l}})},hn=(s,i,t)=>Math.max(i,Math.min(t,s)),Ht=(s,i,t,n,l)=>{const r=Math.floor(i/Math.max(1,t)),o=hn(r-l,0,Math.max(0,s)),x=hn(o+n+l*2,0,s),h=o*t,M=Math.max(0,s*t);return{startIndex:o,endIndex:x,offsetY:h,totalHeight:M}},lr=s=>s&&s.classList.contains("sf-list-item")&&!s.classList.contains("sf-list-group-item")&&!s.classList.contains("sf-disabled")&&!s.classList.contains("sf-display-none"),ar="sf-list-group-item",ir="sf-list-item",cr="sf-level",ur="sf-has-child",fr="sf-disabled",dr="sf-navigable",pr=(s,i,t,n,l,r,o,x,h,M,C)=>{const g=e.useMemo(()=>({...Jt,...i}),[i]),m=e.useMemo(()=>rr(s,g),[s,g]),H=e.useMemo(()=>{const a=m[String(g.id)];return a!=null&&String(a)!==""?String(a):Un("listitem")},[m,g.id]),y=e.useMemo(()=>!!(Object.prototype.hasOwnProperty.call(s,"isHeader")&&m.isHeader),[s]),E=e.useMemo(()=>(m[String(g.child)]||[]).length>0,[m,g.child]),_=e.useMemo(()=>C||!!(m[String(g.checked)]&&m[String(g.checked)].toString()==="true"),[m,g.checked,C]),J=e.useMemo(()=>m[String(g.text)]||(g.id&&m[String(g.id)]?m[String(g.id)].toString():""),[g.text,g.id,m]),W=e.useMemo(()=>String(g.icon)in m&&!ie(m[String(g.icon)]),[m,g.icon]),K=e.useMemo(()=>!!m[String(g.imageUrl)],[m,g.imageUrl]),N=e.useMemo(()=>!!m[String(g.url)],[m,g.url]),S=e.useMemo(()=>!y&&l?typeof l=="function"?l(s):l:y&&r?typeof r=="function"?r(s):r:null,[y,r,l,s]),d=e.useMemo(()=>[y?ar:ir,y&&t===0?"sf-list-group-first-item":"",`${cr}-${(o==null?void 0:o.level)??1}`,m&&!ie(m[String(g.disabled)])&&m[String(g.disabled)].toString()==="true"?fr:"",E?ur:"",x?"sf-checklist":"",(h?M??"":t===n?x?"sf-focused":"sf-active":"")||"",m&&m[String(g.url)]?dr:"",m&&!ie(m[String(g.visible)])&&m[String(g.visible)].toString()==="false"?"sf-display-none":"",m&&x&&_?"sf-active":""].filter(Boolean).join(" ").trim(),[y,o==null?void 0:o.level,m,g.disabled,E,x,h,M,t,n,C]),u=e.useMemo(()=>{const a={className:d,role:(o==null?void 0:o.groupItemRole)!==""&&(o==null?void 0:o.itemRole)!==""?y?o==null?void 0:o.groupItemRole:o==null?void 0:o.itemRole:void 0,"aria-level":(o==null?void 0:o.groupItemRole)==="presentation"||(o==null?void 0:o.itemRole)==="presentation"||o==null?void 0:o.level};return ie(m)||ie(m[String(g.tooltip)])||(a.title=String(m[String(g.tooltip)])),a},[d,o,y,g,t,m]),v=e.useMemo(()=>{if(!m||!Object.prototype.hasOwnProperty.call(m,String(g.htmlAttributes))||!m[String(g.htmlAttributes)])return u;let a={...u};const j=m[String(g.htmlAttributes)],{className:L,style:D,...V}=j;return L&&(a.className=`${a.className||""} ${L}`.trim()),D&&(a.style={...a.style,...D}),a={...a,...V},a},[u,m,g.htmlAttributes]);return{mergedFields:g,fieldData:m,uid:H,grpLI:y,checked:_,liProps:v,displayText:J,hasChild:E,hasIcon:W,hasImage:K,hasUrl:N,templateContent:S,ariaAttributes:o}},gr="sf-list-icon",mn="sf-list-text",hr="sf-list-url",mr="sf-list-img",yr="sf-anchor-wrap",xr=e.memo(({item:s,fields:i,index:t,focusedIndex:n,parentClass:l,itemTemplate:r,groupTemplate:o,ariaAttributes:x,checkBox:h,checkBoxPosition:M,isChecked:C,as:g,onItemClick:m,onItemKeyDown:H,getItemProps:y,...E})=>{if(ie(s))return null;const{ripple:_}=Wt(),{rippleMouseDown:J,Ripple:W}=_n(_),{className:K,...N}=e.useMemo(()=>(y==null?void 0:y({item:s,index:t}))||{},[y,s,t]),S=pr(s,i,t,n,r,o,x,h,l,K,C),d=g??"li",u=e.useCallback(R=>{m==null||m(R,t)},[m,t]),v=e.useCallback(R=>{H==null||H(R,t)},[H,t]),a={...S.liProps,...E,...N,onClick:u,onKeyDown:v,onMouseDown:J},j=()=>p.jsx("span",{className:mn,children:S.displayText}),L=()=>p.jsx(Wn,{className:"sf-font-size-lg"}),D=({position:R})=>p.jsx(Kn,{className:`sf-listview-checkbox sf-checkbox-${R.toLowerCase()}`,checked:S.checked}),V=()=>p.jsxs(p.Fragment,{children:[S.hasIcon&&p.jsx("div",{className:gr,children:S.fieldData[String(S.mergedFields.icon)]}),S.hasImage&&p.jsx("img",{className:mr,src:String(S.fieldData[String(S.mergedFields.imageUrl)]),alt:"Icon"})]});return p.jsxs(d,{"data-value":S.uid,"data-index":t,...a,children:[S.templateContent?S.templateContent:p.jsxs(p.Fragment,{children:[l&&S.displayText,!l&&p.jsx("div",{className:"sf-list-text-content",children:S.hasUrl?p.jsx("a",{className:`${mn} ${hr}`,href:String(S.fieldData[String(S.mergedFields.url)]),children:p.jsxs("div",{className:yr,children:[p.jsx(V,{}),S.displayText,S.hasChild&&p.jsx(L,{})]})}):p.jsxs(p.Fragment,{children:[p.jsx(V,{}),!S.fieldData.isHeader&&h&&(M==="Left"?p.jsxs(p.Fragment,{children:[p.jsx(D,{position:"Left"}),p.jsx(j,{}),S.hasChild&&p.jsx(L,{})]}):p.jsxs(p.Fragment,{children:[p.jsx(j,{}),p.jsx(D,{position:"Right"}),S.hasChild&&p.jsx(L,{})]})),!h&&p.jsxs(p.Fragment,{children:[p.jsx(j,{}),S.hasChild&&p.jsx(L,{})]})]})})]}),!S.grpLI&&_&&p.jsx(W,{})]},S.uid)}),Sr=({checkBox:s,fields:i,listItemDatas:t,onSelect:n,setListItemDatas:l,scrollParent:r})=>{const[o,x]=e.useState(null),[h,M]=e.useState([]),C=d=>{const u=r!=null&&r.current&&"element"in r.current&&r.current.element?r.current.element:r==null?void 0:r.current;if(!u)return;const v=Math.max(0,Math.min(d,Math.max(0,(t==null?void 0:t.length)-1)));x(t[Number(v)]),Ft(v,u)},g=d=>{const u=i.disabled,v=d.isHeader===!0,a=u?d[String(u)]===!0||d[String(u)]==="true":!1,j=d[String(i.visible)]===!0;return!v&&!a&&!j},m=e.useCallback((d,u,v)=>{const a={data:u,event:d,selected:!0,index:v},j=(i==null?void 0:i.id)||"id",L=o?Math.max(0,t.findIndex(D=>String(D[String(j)])===String(o[String(j)])))===v:!1;if(n==null||n(a,L),!u[String(i.child)]){const D=u[String(j)].toString();M([D.toString()]),x(u)}},[n,l,t,o,i]),H=e.useCallback((d,u,v)=>{g(d)&&m(u,d,v)},[m,t]),y=e.useCallback(d=>{const u=i.checked||"checked",v=t.map(a=>{if(a[String(i.id)].toString()===d){const j=a[String(u)];return j===!0||j==="true"?(M(D=>D.filter(V=>V.toString()!==d.toString())),{...a,[u]:!1}):(M(D=>[...D,d.toString()]),{...a,[u]:!0})}return a});l(v)},[i,t,l]),E=e.useCallback((d,u,v)=>{var L;if(!d)return;const a=(L=d[String(i.id)])==null?void 0:L.toString(),j={data:d,event:u,index:v};n==null||n(j,!1),y(a),x(d)},[n,y,h,i]),_=(d,u,v,a)=>{let j=a==="arrowKey"?d+u:d;const L=i.disabled;for(;j>=0&&j<v.length;){const D=v[Number(j)],V=D.isHeader===!0,R=L?D[String(L)]===!0||D[String(L)]==="true":!1,Q=D[String(i.visible)]===!0;if(!V&&!R&&!Q)return j;j+=u}return-1},J=e.useCallback((d,u,v)=>{const j=_(d,u?-1:1,t,v);C(j!==-1?j:d)},[t]),W=e.useCallback((d,u)=>{if(!t||t.length===0)return;const v=u?t.length-1:0;J(v,u,"homeKey")},[t]),K=e.useCallback((d,u)=>{if(!t||t.length===0)return;const v=(i==null?void 0:i.id)||"id",a=o?Math.max(0,t.findIndex(L=>String(L[String(v)])===String(o[String(v)]))):-1,j=a===-1?u?t.length-1:-1:a;J(j,u,"arrowKey")},[t,o,i==null?void 0:i.id]),N=e.useCallback((d,u)=>{if(s&&Object.keys(t).length){const v=t[Number(u)];E(v,d,u)}},[s,t,E]),S=e.useCallback((d,u)=>{switch(d.key){case"Home":d.preventDefault(),W(d,!1);break;case"End":d.preventDefault(),W(d,!0);break;case"ArrowDown":d.preventDefault(),K(d,!1);break;case"ArrowUp":d.preventDefault(),K(d,!0);break;case" ":d.preventDefault(),N(d,u);break}},[W,K,s,N]);return{focusedItem:o,activeItemsId:h,handleSelection:H,keyActionHandler:S,setCheckboxLI:E}},br=(s,i)=>{const{items:t,itemSize:n,pageSize:l,overscanCount:r=5,scrollParent:o,height:x=360,onScrollRequest:h,role:M="listbox",showSkeleton:C,initialVisibleIndex:g=0,itemContent:m,style:H,totalCount:y,className:E,..._}=s,J=e.useMemo(()=>typeof y=="number"&&y>0?y:t.length,[y,t.length]),[W,K]=e.useState(()=>Ht(J,0,n,l,r)),[N,S]=e.useState(0),[d,u]=e.useState(!1),v=e.useRef(null),a=e.useRef(!1),j=e.useRef(0),L=e.useRef(!1),D=e.useRef(null),V=e.useRef(0),R=e.useRef(0),Q=e.useMemo(()=>Math.max(0,Math.floor(N/Math.max(1,n))),[N,n]),P=e.useMemo(()=>{if(!t||t.length===0)return-1;const ce=Math.min(Q,t.length-1);for(let F=ce;F>=0;F--){const me=t[Number(F)];if(me.isHeader)return F}return-1},[t,Q]),B=e.useMemo(()=>P>=0?t[Number(P)]:null,[t,P]),Y={items:t,itemSize:n,pageSize:l,overscanCount:r,scrollParent:o,height:x,showSkeleton:C,initialVisibleIndex:g,totalCount:y};e.useImperativeHandle(i,()=>({...Y,element:(o==null?void 0:o.current)||v.current}),[Y]),e.useEffect(()=>{K(Ht(J,N,n,l,r))},[J,n,l,r]),e.useEffect(()=>{if(L.current)return;const ce=(o==null?void 0:o.current)||v.current;if(!ce)return;const me=Math.max(0,Math.min(g,Math.max(0,J)))*n;ce.scrollTop=me,L.current=!0,S(me),K(Ht(J,me,n,l,r))},[o==null?void 0:o.current,g,J,n,l,r]);const z=e.useMemo(()=>{const ce=Math.min(W.startIndex,t.length),F=Math.min(W.endIndex,t.length);return t.slice(ce,F)},[t,W.startIndex,W.endIndex]),de=e.useCallback(async(ce,F)=>{if(!h||!(F.endIndex>=t.length))return;const f=t.length;let b=l+r;if(typeof y=="number"&&y>0){const A=Math.min(J,F.endIndex);A>t.length&&(b=A)}if(a.current||j.current>t.length)return;a.current=!0,u(!0),j.current=f+b;const T=await h({startIndex:f,count:b,originalEvent:ce});Promise.resolve(T).catch(()=>{u(!1)}).finally(()=>{a.current=!1,u(!1)})},[h,t.length,l,r,d,J,y]),xe=e.useCallback(ce=>{const F=(o==null?void 0:o.current)||v.current;if(!F||d)return;const me=F.scrollTop,f=Ht(J,me,n,l,r),b=V.current??0;if(Math.abs(f.startIndex-b)>r&&D.current){const A=f.offsetY||0;A!==R.current&&(D.current.style.transform=`translate3d(0px, ${A}px, 0px) translateZ(0px)`,R.current=A)}de(ce,f),requestAnimationFrame(()=>{V.current=f.startIndex,S(me),K(f)})},[n,l,r,J,t.length,o,de,d]);e.useEffect(()=>{const ce=(o==null?void 0:o.current)||v.current;if(ce)return ce.addEventListener("scroll",xe,{passive:!0}),()=>ce.removeEventListener("scroll",xe)},[xe,o==null?void 0:o.current]),e.useEffect(()=>{C&&(t.length===0&&h?u(!0):t.length>0&&u(!1))},[t.length,h,C]);const je=e.useCallback(()=>p.jsxs(p.Fragment,{children:[B&&N>=n&&p.jsx("div",{className:"sf-pinned-group",children:m(P,B)}),p.jsx("div",{className:"sf-virtual-content sf-pos-relative",style:{height:W.totalHeight},children:p.jsx("div",{className:"sf-virtual-items",ref:D,style:{transform:`translate3d(0px, ${W.offsetY}px, 0px) translateZ(0px)`},children:C&&d&&z.length!==0?Array.from({length:z.length}).map((ce,F)=>p.jsx("div",{className:"sf-list-skeleton",style:{height:n}},`skeleton-${F}`)):z.map((ce,F)=>{const me=W.startIndex+F;return m(me,ce)})})})]}),[n,W.totalHeight,W.offsetY,C,d,z,W.startIndex,m,B,P,N]),Te=e.useMemo(()=>["sf-virtual-scroll-parent",E].filter(Boolean).join(" ").trim(),[E]);return o?je():p.jsx("div",{ref:v,role:M,className:Te,style:{height:x,...H},..._,children:je()})},vr=e.forwardRef(br),yn="sf-list-parent sf-ul",Cr={level:1,listRole:"list",listLabel:"list",itemRole:"listitem",groupItemRole:"group"},Jt={id:"id",text:"text",url:"url",checked:"checked",disabled:"disabled",icon:"icon",child:"child",visible:"visible",tooltip:"tooltip",htmlAttributes:"htmlAttributes",imageUrl:"imageUrl",groupBy:void 0},kr=e.memo(e.forwardRef(({items:s,fields:i=Jt,scrollParent:t,checkBox:n=!1,checkBoxPosition:l=_t.Left,virtualization:r,parentClass:o,itemTemplate:x,groupTemplate:h,ariaAttributes:M,getItemProps:C,onItemKeyDown:g,onSelect:m,setListItemDatas:H,onScrollRequest:y,disableDefaultInteractions:E=!1,disabled:_=!1},J)=>{M={...Cr,...M};const K=e.useRef(null),N=e.useRef(null);e.useImperativeHandle(J,()=>K.current,[]);const S=Sr({checkBox:n,fields:i,listItemDatas:s||[],onSelect:m,setListItemDatas:H||(()=>{}),scrollParent:t!=null&&t.current?t:N}),d=(i==null?void 0:i.id)??"id",u=e.useMemo(()=>{var V;if(!S.focusedItem||!s)return-1;const D=String((V=S.focusedItem)==null?void 0:V[String(d)]);return ie(D)?-1:s.findIndex(R=>String(R==null?void 0:R[String(d)])===String(D))},[S.focusedItem,s,d]),v=e.useCallback((D,V)=>{if(_)return;if(E){m==null||m({event:D,index:V},u===V);return}const R=D.currentTarget,Q=s==null?void 0:s[Number(V)];Q&&(n&&lr(R)?R.classList.contains("sf-has-child")?S.handleSelection(Q,D,V):S.setCheckboxLI(Q,D,V):S.handleSelection(Q,D,V))},[E,_,n,S]),a=e.useCallback(D=>{_||(E||S.keyActionHandler(D,u),g==null||g(D,u))},[E,S,g,u,_]),j=e.useMemo(()=>[o||"sf-list-container",r?"sf-virtualization":""].filter(Boolean).join(" ").trim(),[r,o]),L=e.useCallback((D,V)=>p.jsx(xr,{item:V,fields:i,index:D,onItemClick:v,getItemProps:C,itemTemplate:x,groupTemplate:h,checkBoxPosition:l,parentClass:o,ariaAttributes:M,checkBox:n,focusedIndex:u,isChecked:S.activeItemsId.includes(String(V==null?void 0:V[String(d)])),as:r?"div":"li"},`sf-item-${D}`),[i,v,C,x,h,l,o,M,n,u,S.activeItemsId,d]);return p.jsx("div",{ref:K,className:j,children:r?p.jsx("div",{ref:N,className:yn,role:(M==null?void 0:M.listRole)??void 0,"aria-label":(M==null?void 0:M.listLabel)??void 0,tabIndex:0,onKeyDown:a,children:p.jsx(vr,{items:s,itemSize:r==null?void 0:r.itemSize,pageSize:r==null?void 0:r.pageSize,overscanCount:r==null?void 0:r.overscanCount,showSkeleton:r.showSkeleton,scrollParent:t||N,onScrollRequest:y,itemContent:L})}):p.jsx("ul",{ref:N,className:yn,role:(M==null?void 0:M.listRole)??void 0,"aria-label":(M==null?void 0:M.listLabel)??void 0,tabIndex:0,onKeyDown:a,children:s==null?void 0:s.map((D,V)=>L(V,D))})})}));var Mt;(function(s){s.FetchViewPort="FetchViewPort",s.FetchAll="FetchAll"})(Mt||(Mt={}));const Ir=s=>{const{dropdownValue:i,inputElementRef:t,required:n,valid:l,validationMessage:r}=s,o=e.useMemo(()=>l!==void 0?!!l:n?i!=null:!0,[l,n,i]);return e.useEffect(()=>{const x=o?"":r||"",h=(t==null?void 0:t.current)??void 0;h&&typeof h.setCustomValidity=="function"&&h.setCustomValidity(x)},[o,r,t]),{isInputValid:o}},Mn=(s,i,t,n)=>{const l=s.length>0&&(typeof s[0]=="string"||typeof s[0]=="number"||typeof s[0]=="boolean");if(l||!i.groupBy)if(l&&t!==wt.None){const r=[...s];return t===wt.Ascending?r.sort((o,x)=>String(o).localeCompare(String(x))):t===wt.Descending&&r.sort((o,x)=>String(x).localeCompare(String(o))),r}else{const r=In(t,(i==null?void 0:i.text)||"text",n),o=wn(s,r);return o&&Array.isArray(o.result)?o.result:o}else return nr(s,i,t)},jn=s=>{switch(String(s??"")){case"StartsWith":return"startsWith";case"EndsWith":return"endsWith";case"Contains":return"contains";default:return"contains"}},Nn=(s,i,t)=>{if(ie(s)||!Array.isArray(i)||i.length===0)return-1;const n=(t==null?void 0:t.value)||"value",l=String(typeof s=="object"?fe(n,s):s);for(let r=0;r<i.length;r++){const o=i[r];if(!ie(o)&&!(typeof o=="object"&&(o!=null&&o.isHeader))){if(typeof o=="object"){const x=fe(n,o);if(!ie(x)&&String(x)===l)return r}else if(String(o)===l)return r}}return-1},ke=(s,i,t)=>{let n;return i==="value"?n=(t==null?void 0:t.value)??"value":n=(t==null?void 0:t.text)??"text",typeof s=="string"||typeof s=="number"||typeof s=="boolean"?s:typeof s=="object"&&s!==null?fe(n,s):""},St=s=>typeof s=="string"||typeof s=="number"||typeof s=="boolean",wr=(s,i)=>{const t=s??"",n=(i??"").toLowerCase();if(!n)return[{text:t,highlight:!1}];const l=t.toLowerCase(),r=[];let o=0;for(;o<t.length;){const x=l.indexOf(n,o);if(x===-1){r.push({text:t.slice(o),highlight:!1});break}x>o&&r.push({text:t.slice(o,x),highlight:!1}),r.push({text:t.slice(x,x+n.length),highlight:!0}),o=x+n.length}return r},xn=(s,i)=>typeof i=="number"&&i>0&&Array.isArray(s)?s.slice(0,i):s,Mr=s=>{const{isDropdownFiltering:i,ignoreCase:t,ignoreAccent:n,filterType:l,fields:r,dataSource:o,onFilter:x,setListData:h,baseQuery:M,externalFilterInputRef:C}=s,[g,m]=e.useState(""),H=s.externalTypedString!==void 0?s.externalTypedString:g,y=s.setExternalTypedString||m,E=e.useCallback((N,S)=>{if((C==null?void 0:C.current)!=null&&C.current.value.trim()!==""){const d=S||M||new Me;if(!S){const u=jn(l);Array.isArray(N)&&N.length>0&&(typeof N[0]=="string"||typeof N[0]=="number"||typeof N[0]=="boolean")?d.where("",u,C.current.value,t,n):d.where(r.text||"text",u,C.current.value,t,n)}h(N,d,!0,C.current.value)}else h(N,S||M||new Me,!0)},[l,r,t,n,h,M]),_=e.useCallback((N,S)=>{if(i&&(C==null?void 0:C.current)!=null){const d={preventDefaultAction:!1,text:S,event:N};x&&x(d),!d.preventDefaultAction&&o&&E(o,null)}},[i,E,x,o]),J=e.useCallback((N,S)=>{E(N,S)},[H,t,E]),W=e.useCallback(N=>{y(N.target.value),_(N,N.target.value)},[_]),K=e.useCallback(N=>{N.preventDefault(),N.stopPropagation(),y(""),h(o,M||new Me,!0)},[y,h,o,M]);return{handleInputChange:W,clearText:K,filter:J}},Bt=(s,i)=>s===null?null:e.isValidElement(s)?s:typeof s=="function"?s():null,jr=({headerTemplate:s})=>p.jsx(p.Fragment,{children:Bt(s)}),Nr=e.memo(jr),Tr=({footerTemplate:s})=>p.jsx(p.Fragment,{children:Bt(s)}),Dr=e.memo(Tr),Fr=({noRecordsTemplate:s,defaultText:i})=>{const t=p.jsx("div",{className:"sf-content sf-dd-base sf-dd-nodata",children:i}),n=Bt(s);return p.jsx(p.Fragment,{children:n??t})},Lr=e.memo(Fr),Ar=({errorTemplate:s,defaultText:i})=>{const t=p.jsx("div",{className:"sf-content sf-dd-base sf-dd-nodata",children:i}),n=Bt(s);return p.jsx(p.Fragment,{children:n??t})},Vr=e.memo(Ar),Rr={text:"text",value:"value",disabled:"disabled",groupBy:void 0,htmlAttributes:"htmlAttributes"},tt={root:"sf-dd-base",content:"sf-content",selected:"sf-active",focus:"sf-item-focus",li:"sf-list-item",disabled:"sf-disabled",grouping:"sf-dd-group",hover:"sf-hover",noData:"sf-dd-nodata"},Tn=e.forwardRef((s,i)=>{const{dataSource:t=[],fields:n=Rr,value:l,query:r,isDropdownFiltering:o=!1,filterPlaceholder:x="",ignoreCase:h,ignoreAccent:M,filterType:C="StartsWith",size:g=ut.Medium,itemTemplate:m,groupTemplate:H,headerTemplate:y,footerTemplate:E,sortOrder:_=wt.None,noRecordsTemplate:J,onErrorTemplate:W,allowObjectBinding:K=!1,activeIndex:N,id:S,debounceDelay:d=0,remoteCacheRef:u,itemData:v,virtualization:a,focusedItem:j,externalFilterInputRef:L,maxSuggestions:D,forceFilterOnOpen:V,onError:R,onItemClick:Q,onFilter:P,keyActionHandler:B,onDataRequest:Y,onDataLoad:z,onScroll:de}=s,{locale:xe}=Wt(),Te=vn("dropdownList",{noRecordsMessage:"No Records Found",errorMessage:"Request Failed"},xe||"en-US"),ce=(r==null?void 0:r.clone())??new Me,[F,me]=e.useState([]),[f,b]=e.useState(!1),[T,A]=e.useState(!1),[U,X]=e.useState(null),[ge,Ve]=e.useState(null),[ze,De]=e.useState(""),[Ue,ye]=e.useState(!1),bt=e.useRef([]),oe=e.useRef(null),ot=e.useRef(ze),_e=e.useRef(null),Ie=e.useRef(null),re=e.useRef(null),Re=e.useRef([]),lt=e.useRef(0),ht=e.useRef(!1),at=e.useCallback(c=>{ht.current=c,b(c)},[]),We=e.useCallback(c=>{let k;if(o){k=c.clone();const w=ot.current??"";if(w!==""){const O=jn(C),q=Fe(t).typeof;if(!(t instanceof Ye)&&(q==="string"||q==="number"||q==="boolean"))k.where("",O,w,h,M);else{const Be=n!=null&&n.text?n.text:"text";k.where(Be,O,w,h,M)}}}else k=c.clone();return k.clone()},[r,o,C,h,M,n]),nt=e.useCallback(c=>{T||A(!0);const k=Mn(c,n,_,r??new Me);me(k)},[n,_,r,T]),Ee=e.useCallback(c=>{if(!(t instanceof Ye)||!(u!=null&&u.current)||!c)return;const k=Array.from(u==null?void 0:u.current),w=typeof c=="string"||typeof c=="number"||typeof c=="boolean",O=String(w?c:fe(n.value,c));k.some(te=>String(w?typeof te!="object"&&te:typeof te=="object"&&fe(n.value,te))===O)||(k.push(c),u.current=k)},[n,u]),it=e.useCallback((c,k,w,O)=>{var Be;if(w&&c instanceof Ye&&a&&a.scrollMode===Mt.FetchViewPort){ft(c,k,w,O);return}let q;Array.isArray(c)?q=c.filter(Oe=>Oe!=null):q=c,ot.current=O??"";const te={data:q,query:k};if(q instanceof Ye){const Oe=q;if(o&&!w&&Ee(v),u!=null&&u.current&&!w){const G=u.current,Z=new Ye(G),se=te.query?te.query:We(new Me);se.queries.some(kt=>kt.fn==="onTake")&&(se.queries=(Be=se==null?void 0:se.queries)==null?void 0:Be.filter(kt=>kt.fn!=="onTake"),se.take(G.length));const ve=se.executeLocal(Z),Pe={data:ve&&Array.isArray(ve.result)?ve.result:ve};z==null||z(Pe),nt(Pe.data);return}f||(Y==null||Y({data:te.data,query:k?te.query:We(new Me)}),b(!0),ye(!1),Oe.executeQuery(te.query?te.query:We(new Me)).then(G=>{const Z=G&&Array.isArray(G.result)?G.result:[];if(u&&!w&&(u.current=Z),!G.cancel){const se={data:G.result};se.data=xn(se.data,D),z==null||z(se,w),nt(se.data)}b(!1),ye(!1)}).catch(G=>{b(!1),ye(!0),A(!1),R==null||R(G)}))}else{const Oe=new Ye(te.data);let G=We(te.query||new Me).executeLocal(Oe);G=xn(G,D);const Z={data:G};z==null||z(Z),nt(Z.data),b(!1),ye(!1)}},[f,We,_,R,W,Y,z,nt,Ee]),ft=e.useCallback(async(c,k,w,O,q)=>{var G,Z;w&&(Re.current=[]),ot.current=O??"";const te={data:c,query:k},Be=c;o&&!w&&v&&Ee(v);const Oe=!!(o&&((G=oe==null?void 0:oe.current)!=null&&G.value));if(w&&a&&Oe){const se=a.pageSize+(a.overscanCount??5),ve=We(new Me).skip(0).take(se).requiresCount();ht.current||(Y==null||Y({data:te.data,query:ve}),at(!0),ye(!1),await Be.executeQuery(ve).then(ne=>{const Pe=ne&&Array.isArray(ne.result)?ne.result:[];Re.current=Re.current.concat(Pe),lt.current++,nt(Re.current),at(!1),ye(!1)}).catch(ne=>{at(!1),ye(!0),A(!1),R==null||R(ne)}));return}if(u!=null&&u.current&&!q){const se=u.current,ve=new Ye(se),ne=te.query;ne.queries.some(mt=>mt.fn==="onTake")&&(ne.queries=(Z=ne==null?void 0:ne.queries)==null?void 0:Z.filter(mt=>mt.fn!=="onTake"),ne.take(se.length));const Pe=ne.executeLocal(ve),Dt={data:Pe&&Array.isArray(Pe.result)?Pe.result:Pe};z==null||z(Dt),nt(Dt.data);return}ht.current||(Y==null||Y({data:te.data,query:te.query}),at(!0),ye(!1),await Be.executeQuery(te.query).then(se=>{const ve=se&&Array.isArray(se.result)?se.result:[];if(Oe){let ne=[];Array.isArray(Re.current)&&(ne=Re.current);const Pe=ne.concat(ve);Re.current=Pe}else if(u&&!w){let ne=[];Array.isArray(u.current)&&(ne=u.current);const Pe=ne.concat(ve);u.current=Pe}se.cancel||(Oe&&(Re!=null&&Re.current)?nt(Re.current):u!=null&&u.current&&(z==null||z({data:u.current}),nt(u.current))),at(!1),ye(!1)}).catch(se=>{at(!1),ye(!0),A(!1),R==null||R(se)}))},[We,R,Y,z,nt,Ee,o,oe,v,a,ot,u,Re,at,A,ye,lt,ht]),qt=e.useCallback(async c=>{var O,q;if(!(t instanceof Ye)||a&&a.scrollMode===Mt.FetchAll){de==null||de(c);return}const k=!!(o&&((O=oe==null?void 0:oe.current)!=null&&O.value));ot.current=k?(q=oe==null?void 0:oe.current)==null?void 0:q.value:ot.current;const w=We(new Me).skip(c.startIndex).take(c.count).requiresCount();await ft(t,w,!1,void 0,!0),de==null||de(c)},[t,de,ft,We,o,oe,ot,a]),{handleInputChange:jt,clearText:le,filter:Ae}=Mr({isDropdownFiltering:o,ignoreCase:h,ignoreAccent:M,filterType:C,fields:n,dataSource:t,baseQuery:ce,onFilter:P,setListData:it,externalTypedString:ze,setExternalTypedString:De,externalFilterInputRef:L??oe}),dt=e.useMemo(()=>{const c=Array.isArray(F)&&F.length>0&&(typeof F[0]=="string"||typeof F[0]=="number"||typeof F[0]=="boolean");return[tt.content,tt.root,!c&&n.groupBy?tt.grouping:"",F.length===0?"sf-dd-nodata":""].filter(Boolean).join(" ")},[n.groupBy,F]),Nt=p.jsx(Lr,{noRecordsTemplate:J,defaultText:Te.getConstant("noRecordsMessage")}),$e=p.jsx(Vr,{errorTemplate:W,defaultText:Te.getConstant("errorMessage")});e.useEffect(()=>{if(l!=null&&F.length>0){const c=new Map;F.forEach((w,O)=>{const q=String(typeof w=="object"?fe(n.value??"",w):w);c.set(q,O)});const k=c.get(String(l))??-1;k!==-1&&X(k)}else l==null&&X(null)},[l,F,n]),e.useEffect(()=>{o&&oe.current&&oe.current.focus({preventScroll:!0})},[o,oe.current]),e.useEffect(()=>{var c,k,w;if(!T||re.current!==JSON.stringify(t))if(re.current=JSON.stringify(t)??null,t instanceof Ye&&a&&a.scrollMode===Mt.FetchViewPort){const O=a.pageSize+(a.overscanCount??5),q=We(new Me).skip(0).take(O).requiresCount();ft(t,q)}else if(V&&((c=L==null?void 0:L.current)==null?void 0:c.value.trim())!=="")if(d&&d>0){const O=L?(k=L.current)==null?void 0:k.value:(w=oe.current)==null?void 0:w.value;Ie.current&&(clearTimeout(Ie.current),Ie.current=null),De(O),Ie.current=window.setTimeout(()=>{Ae(t,void 0),clearTimeout(Ie.current),Ie.current=null},d)}else Ae(t,void 0);else it(t,r)},[t,r,T]),e.useEffect(()=>{F.length>0?Ve(N||0):Ve(null)},[F,N]),e.useEffect(()=>()=>{Ie.current&&(clearTimeout(Ie.current),Ie.current=null)},[]);const Ke=e.useCallback((c,k)=>{var G;const w=(G=_e==null?void 0:_e.current)==null?void 0:G.parentElement,O=w.style.display;w.style.visibility="hidden",w.style.display="block";const q=k.offsetTop,te=q+k.offsetHeight,Be=c.scrollTop,Oe=c.scrollTop+c.clientHeight;te>Oe?c.scrollTop=te-c.clientHeight:q<Be&&(c.scrollTop=Math.max(0,q)),w.style.visibility="",w.style.display=O},[_e]);e.useEffect(()=>{if(!T||ie(v))return;const c=typeof v=="object"&&v!==null?fe((n==null?void 0:n.value)??"value",v):v;if(ie(c))return;const k=Xe(),w=k==null?void 0:k.find(q=>{var te;return((te=q==null?void 0:q.dataset)==null?void 0:te.value)===String(c)}),O=ee();if(w&&O)Ke(O,w);else if(a&&O){const q=Nn(v,F,n);q!==-1&&Ft(q,O)}},[T]);const Fe=e.useCallback(c=>{let k={typeof:null,item:null};if(!Array.isArray(c)||c.length===0)return k;for(let w=0;w<c.length;w++)if(c[w]!==null&&c[w]!==void 0&&!(typeof c[w]=="string"||typeof c[w]=="number"||typeof c[w]=="boolean"?ie(c[w]):ie(fe(n.value,c[w]))))return k={typeof:typeof c[w],item:c[w]};return k},[n]),Se=e.useCallback(c=>{if(F&&F.length){const k=Fe(F);if(typeof fe(n.value,k.item)=="number"||k.typeof==="number")return parseFloat(c);if(typeof fe(n.value,k.item)=="boolean"||k.typeof==="boolean")return c==="true"||""+c=="true"}return c},[F,n,Fe]),we=e.useCallback(c=>{if(!ie(F)){const k=Fe(F).typeof;if(k==="string"||k==="number"||k==="boolean")for(let w=0;w<F.length;w++){const O=F[w];if(!ie(O)&&String(O)===String(c))return O}else for(let w=0;w<F.length;w++){const O=F[w];if(!ie(O)&&String(fe(n.value,O))===String(c))return O}}},[F,n,Fe]),Tt=e.useCallback((c,k,w)=>ie(c)?!1:w?String(c).toLowerCase()===(k==null?void 0:k.toString().toLowerCase()):String(c)===(k==null?void 0:k.toString()),[]),be=e.useCallback((c,k)=>{if(!ie(F)){const O=F.find(q=>!ie(fe(n.value,q))&&Tt(String(fe(n.value||"",q)),c,k));return O?fe(n.text||n.value,O):null}return null},[F,n,Fe]),Ne=e.useCallback(c=>{const k=Fe(t).typeof;return k==="string"||k==="number"||k==="boolean"?c.toString():be(c,!!h)||""},[be,Fe,t]),He=e.useCallback(c=>{var w;const k=((w=c.event.currentTarget.dataset)==null?void 0:w.value)??null;if(k){let O;const q=Fe(t).typeof;q==="string"||q==="number"||q==="boolean"?O=k:O=we(Se(k)),O&&Ne(k)}X(c.index),Ve(null),Q==null||Q(c.event,c.index)},[we,Se,Ne,Q,Fe,t]),Je=e.useCallback(c=>{let k="",w="",O=!1;if(l!==null)if(typeof c.item=="string"||typeof c.item=="number"||typeof c.item=="boolean")k=w=String(c.item),O=String(c.item)===String(l);else if(k=String(fe(n.value||"",c.item)),w=String(fe(n.text||n.value||"",c.item)),K){const G=n==null?void 0:n.value,Z=G&&typeof l=="object"&&l!==null?l[G]:void 0;O=k===String(Z??"")}else O=k===String(l);let q=U!==null?c.index===U:O;try{const G=v;if(G!=null){const Z=String(typeof G=="object"?fe(n.value||"value",G):G),se=String(typeof G=="object"?fe(n.text||n.value||"",G):G);q=String(k)===Z&&String(w)===se}}catch{q=!1}let te=v?!1:(F==null?void 0:F[0]).isHeader?c.index===1:c.index===0;j!=null&&(te=String(ke(c.item,"value",n))===String(ke(j.item,"value",n)));const Be=n.disabled&&typeof c.item=="object"&&fe(n.disabled,c.item)===!0;return{className:[q?tt.selected:"",te?tt.focus:"",Be?tt.disabled:""].filter(Boolean).join(" "),id:`${S}-option-${c.index}`,"aria-selected":q?"true":"false","aria-disabled":Be?"true":"false",ref:G=>{bt.current[c.index]=G}}},[F,U,dt,l,n,tt,ge,v,S,j]),ae=e.useMemo(()=>!n||Object.keys(n).length===0?n:Object.keys(n).length>0?{id:n==null?void 0:n.value,text:n==null?void 0:n.text,groupBy:n==null?void 0:n.groupBy,disabled:n==null?void 0:n.disabled,htmlAttributes:n==null?void 0:n.htmlAttributes}:n,[n]),Ge=e.useMemo(()=>p.jsx(kr,{getItemProps:Je,items:F,parentClass:dt,itemTemplate:m,groupTemplate:H,fields:ae,ariaAttributes:{itemRole:"option",listRole:"listbox",groupItemRole:"presentation"},onSelect:He,virtualization:a,onScrollRequest:qt,disableDefaultInteractions:!0},`list-base${lt.current}`),[dt,m,H,F,He,Je,n,v,lt]),Xe=e.useCallback(()=>(n.groupBy||m)&&_e.current?Array.from(_e.current.getElementsByClassName(tt.li)):bt.current.filter(Boolean),[n.groupBy,m,tt.li]),ee=e.useCallback(()=>{const c=_e.current;if(!c)return null;const k=c.querySelector(".sf-ul");return k||null},[]),rt=e.useCallback(()=>F,[F,it]),st=e.useCallback(c=>{var O;let k=-1;const w=Xe();for(let q=0;q<w.length;q++){const te=((O=w[q].dataset)==null?void 0:O.value)??null;if(!ie(c)&&!ie(te)&&String(te)===String(c)){k=q;break}}return k},[Xe]),pt=e.useCallback(c=>{var k,w;if(d&&d>0){const O=L?(k=L.current)==null?void 0:k.value:(w=oe.current)==null?void 0:w.value;Ie.current&&(clearTimeout(Ie.current),Ie.current=null),De(O),Ie.current=window.setTimeout(()=>{jt(c),clearTimeout(Ie.current),Ie.current=null},d)}else jt(c)},[d,jt,oe,Ie,De,L]),vt=e.useCallback((c,k,w,O)=>{if(w){pt(w);return}if(O){le(O);return}Ae(c,k)},[Ae,pt,le]);e.useImperativeHandle(i,()=>({getFormattedValue:Se,getDataByValue:we,getIndexByValue:st,getTextByValue:Ne,getScrollContainer:ee,getListItems:Xe,getFilteredListData:rt,filterType:C,externalFilterInputRef:L,filter:vt}),[Se,we,st,Ne,Xe,F,ee]);const Lt=c=>c==="ArrowUp"||c==="ArrowDown"||c==="Home"||c==="End"||c==="PageUp"||c==="PageDown",zt=e.useCallback(c=>{c.key!=="Enter"&&!Lt(c.key)&&(B==null||B(c))},[s.keyActionHandler]),Ct=e.useCallback(c=>{if(c.key==="Enter"){c.stopPropagation(),B==null||B(c);return}if(Lt(c.key)){c.preventDefault(),c.stopPropagation(),B==null||B(c);return}},[B]);return p.jsx(p.Fragment,{children:T?p.jsxs("div",{className:g===ut.Small?"sf-small":g===ut.Large?"sf-large":"sf-medium",ref:_e,children:[o&&!(L!=null&&L.current)&&p.jsx("span",{className:"sf-ddl-filter-parent",children:p.jsxs("span",{className:`sf-input-group sf-control sf-input-focus ${g===ut.Small?"sf-small":g===ut.Large?"sf-large":"sf-medium"}`,children:[p.jsx(Cn,{name:S+"_filter",ref:oe,type:"text",value:ze,className:"sf-input-filter",placeholder:x,title:"Filter",onChange:pt,onKeyUp:zt,onKeyDown:Ct}),f?p.jsx(Kt,{size:g===ut.Small?"16px":"20px",visible:!0}):kn(ze,le)]})}),y&&p.jsx("div",{className:"sf-dd-header",children:p.jsx(Nr,{headerTemplate:y})}),F.length===0?Nt:Ge,E&&p.jsx("div",{className:"sf-dd-footer",children:p.jsx(Dr,{footerTemplate:E})})]}):Ue&&p.jsx("div",{className:tt.root+" "+tt.content+" "+tt.noData,children:$e})})});e.memo(Tn);const Er=(s={})=>{const{value:i,defaultValue:t,open:n,loading:l,onChange:r}=s,[o,x]=e.useState(!!n),[h,M]=e.useState(""),[C,g]=e.useState(!1),[m,H]=e.useState(!!l),[y,E]=e.useState(null),[_,J]=e.useState(null),W=e.useMemo(()=>n!==void 0,[n]),K=e.useMemo(()=>i!==void 0&&!!r,[i,r]),N=e.useMemo(()=>K||i!==void 0?i:t!==void 0?t:null,[K,i,t]),[S,d]=e.useState(N);return e.useEffect(()=>{W&&x(!!n)},[W,n]),e.useEffect(()=>{H(!!l)},[l]),e.useEffect(()=>{K&&d(i)},[K,i]),[{isPopupOpen:o,dropdownValue:S,textValue:h,isSpanFocused:C,isLoading:m,activeIndex:y,itemData:_},{setIsPopupOpen:a=>x(a),setDropdownValue:a=>d(a),setTextValue:a=>M(a),setIsSpanFocused:a=>g(a),setIsLoading:a=>H(a),setActiveIndex:a=>E(a),setItemData:a=>J(a)}]},Or=s=>{const i=e.useMemo(()=>["sf-ddl sf-popup",s.className].filter(Boolean).join(" "),[s.className]),{isPopupOpen:t,open:n,setIsPopupOpen:l,setIsSpanFocused:r,spanElementRef:o,inputElementRef:x,popupRef:h,onOpen:M,onClose:C,popupWidth:g,popupHeight:m}=s,H=e.useMemo(()=>n!==void 0,[n]),y=e.useCallback(N=>{var S;H||(l(!0),(S=x.current)==null||S.focus()),M&&M({event:N})},[H,l,x,M,h]),E=e.useCallback(N=>{H||l(!1),C&&h.current&&C({event:N}),n||r(!0)},[H,l,C,h,n,r,x]),_=e.useCallback(N=>{var a,j,L;const S=N.target,d=!!o.current&&!o.current.contains(S)&&S.isConnected,u=!!((a=h.current)!=null&&a.element)&&!h.current.element.contains(S),v=S instanceof Element?S:null;(t&&d&&u||!d&&((L=(j=h.current)==null?void 0:j.element)!=null&&L.classList.contains("sf-input-group")))&&(E(N),r(!1)),d&&!(v&&v.matches(".sf-list-item"))&&!(v&&v.matches(".sf-input-icon"))&&r(!1)},[t,E,r,o,h]),J=e.useCallback((N,S,d)=>{const u=bn(N);if(!u.includes("%"))return u;const v=parseFloat(u);if(!S||Number.isNaN(v))return u;const a=typeof S.getBoundingClientRect=="function"?S.getBoundingClientRect():null,j=d==="width"?S.offsetWidth:S.offsetHeight,L=a?d==="width"?a.width:a.height:0;let D=0;if(typeof window<"u"&&window.getComputedStyle){const R=window.getComputedStyle(S),Q=d==="width"?R.width:R.height;D=parseFloat(Q||"0")||0}return`${(j||L||D||0)*v/100}px`},[]),W=e.useCallback(()=>J(g,o.current,"width"),[g,o,J]),K=e.useCallback(()=>J(m,x.current,"height"),[m,x,J]);return e.useEffect(()=>(t&&document.addEventListener("mousedown",_),()=>{document.removeEventListener("mousedown",_)}),[t,_]),e.useEffect(()=>{const N=S=>{var u;const d=((u=h.current)==null?void 0:u.element)&&!h.current.element.contains(S.target)&&!o.current.contains(S.target);t&&d&&(E(S),r(!1))};return t&&document.addEventListener("scroll",N,!0),()=>{document.removeEventListener("scroll",N,!0)}},[t,E,h,r]),{showPopup:y,hidePopup:E,setPopupWidth:W,setPopupHeight:K,popupClassNames:i}},Pr=s=>{const{value:i,defaultValue:t,dataSource:n,dataSourceListItems:l,fields:r,isValueControlled:o,allowObjectBinding:x,dropdownbaseRef:h,dropdownValue:M,setDropdownValue:C,setTextValue:g,setActiveIndex:m,setItemData:H,prefetchData:y,spanClickable:E,customValue:_}=s,J=e.useRef(t),W=e.useRef(!1),K=e.useRef(n),N=e.useCallback(a=>{if(Array.isArray(n)){const D=n[0];if((typeof D=="string"||n.length===0)&&typeof a=="boolean"){g("");return}else if(typeof D=="object"&&!x)return}const j=r==null?void 0:r.text,L=j&&a&&typeof a=="object"?String(a[j]):"";g(St(a)?String(a):x&&j?String(L):"")},[n,St,g,x,r==null?void 0:r.text]),S=e.useCallback(a=>{const j=E===!1&&(r!=null&&r.text)?r==null?void 0:r.text:r==null?void 0:r.value;return x&&a&&typeof a=="object"&&j?a[j]??null:a??null},[x,r==null?void 0:r.value,r==null?void 0:r.text,E]),d=e.useCallback((a,j)=>{const L=E===!1&&(r!=null&&r.text)?r==null?void 0:r.text:r==null?void 0:r.value;if(j&&typeof j=="object"&&L){for(let D=0;D<j.length;D++)if(fe(L,j[D].item)===a)return{index:D,textValue:fe(r.text||r.value,j[D].item)}}return{index:-1,textValue:a}},[r==null?void 0:r.value,r==null?void 0:r.text,E]),u=e.useCallback((a,j)=>{if(!Array.isArray(a)||ie(j))return!1;const L=a.length>0&&St(a[0]),D=E===!1&&(r!=null&&r.text)?r==null?void 0:r.text:r==null?void 0:r.value,V=r==null?void 0:r.text,R=new Map;a.forEach((P,B)=>{const Y=L?String(P):D?String(fe(D,P)):"";R.set(Y,B)});const Q=R.get(String(j))??-1;if(Q!==-1){const P=a[Q],B=String(L?P:V?fe(V,P):j);return g(B),m(Q),H==null||H(P),!0}return!1},[r==null?void 0:r.value,r==null?void 0:r.text,St,m,g,E,H]),v=e.useCallback(a=>{if(_){const j=St(a)?String(a):x&&(r!=null&&r.text)?String(a[r.text]):String(a);g(j),m(null),H==null||H(a)}else N(a)},[_,St,x,r==null?void 0:r.text,g,m,H,N]);e.useLayoutEffect(()=>{var L,D,V,R,Q;if(o){const P=i;if(ie(P))g(""),m(null);else{C(P);const B=h!=null&&h.current?(L=h==null?void 0:h.current)==null?void 0:L.getFilteredListData():n;if(B&&Array.isArray(B))u(B,P)||v(P);else if(B instanceof Ye){const Y=S(P);if(ie(Y))g(""),m(null);else{let z=((V=(D=h==null?void 0:h.current)==null?void 0:D.getTextByValue)==null?void 0:V.call(D,Y))??"",de=((Q=(R=h==null?void 0:h.current)==null?void 0:R.getIndexByValue)==null?void 0:Q.call(R,Y))??-1;if(z===""&&!(h!=null&&h.current))if(l&&l.length>0){const{index:xe,textValue:je}=d(Y,l);z=je,de=xe}else y&&y().then(xe=>{!xe||xe.length===0||u(xe,P)||v(P)});g(z),m(de!==-1?de:null)}}}return}const a=JSON.stringify(J.current)!==JSON.stringify(t),j=JSON.stringify(K.current)!==JSON.stringify(n);if(!W.current||a||j){const P=i??t??M;ie(P)?(g(""),m(null)):(C(P),n&&Array.isArray(n)?u(n,P)||v(P):n instanceof Ye&&y&&y().then(B=>{!B||B.length===0||u(B,P)||v(P)})),W.current=!0,J.current=t,K.current=n}},[o,i,t,n,r==null?void 0:r.value,r==null?void 0:r.text,u,C,N,g,m])},$r=s=>{const{isInteractive:i,skipDisabledItems:t,activeIndex:n,isRemoteData:l,dataSourceListItems:r,fields:o,onChange:x,setTextValue:h,setActiveIndex:M,dropdownbaseRef:C,showPopup:g,hidePopup:m,setIsSpanFocused:H,setDropdownValue:y,prefetchData:E,currentItemData:_,setItemData:J,onScroll:W,virtualization:K,filterable:N,spanClickable:S}=s,[d,u]=e.useState(null),v=e.useCallback(f=>f.map(b=>{const T=(o==null?void 0:o.disabled)&&typeof b=="object"&&fe(o.disabled,b)===!0,A=typeof b=="object"&&!!fe("isHeader",b);return{item:b,isDisabled:!!T,isHeader:A}}),[o==null?void 0:o.disabled]),a=e.useCallback(f=>f!=null&&f.isHeader?!0:!!(f!=null&&f.isDisabled),[]),j=e.useCallback((f,b,T)=>{if(!t)return Math.max(0,Math.min(f.length-1,b+T));let A=b;const U=f.length;for(let X=0;X<U&&(A+=T,!(A<0||A>=f.length));X++)if(!a(f[A]))return A;return-1},[t,a]),L=e.useCallback((f,b=!1)=>{if(!t)return b?f.length-1:0;if(b){for(let T=f.length-1;T>=0;T--)if(!a(f[T]))return T;return-1}else{for(let T=0;T<f.length;T++)if(!a(f[T]))return T;return-1}},[t,a]),D=e.useCallback((f,b)=>{if(!t||!a(f[b]))return b;let T=b,A=b;for(;T<f.length-1||A>0;){if(T<f.length-1&&(T++,!a(f[T])))return T;if(A>0&&(A--,!a(f[A])))return A}return-1},[t,a]),V=f=>String(ke(f.item,"text",o)??""),R=(f,b,T)=>{if(!f||f.length===0||!b)return-1;const A=f.length;let U=Math.max(-1,Math.min(A-1,T));for(let X=0;X<A;X++){U=(U+1)%A;const ge=f[U];if(!a(ge)&&V(ge).toLowerCase().startsWith(b))return U}return-1},Q=(f,b,T)=>{const A=ke(f.item,"value",o),U=String(ke(f.item,"text",o));h==null||h(U),A!==void 0&&(y==null||y(A),J==null||J(f.item)),x&&A!==void 0&&x({event:b,previousItemData:T==null?void 0:T.item,value:S?A:U,itemData:f.item})},P=()=>{var b,T;const f=C.current?(T=(b=C.current)==null?void 0:b.getFilteredListData)==null?void 0:T.call(b):null;return Array.isArray(f)?v(f):r},B=f=>{const b=typeof _=="object"&&_!==null?fe((o==null?void 0:o.value)??"value",_):_,T=f.findIndex(A=>String(ke(A.item,"value",o))===String(b??""));return T!==-1||_?T:n??-1},Y=e.useCallback((f,b,T,A)=>{M(T);const U=A>-1?b[A]:void 0;if(Q(b[T],f,U),T>=b.length-1&&K&&W){const ge=Array.isArray(b)?b.length:0,Ve=K.overscanCount??5,ze=K.pageSize+Ve;W({originalEvent:f.nativeEvent,startIndex:ge,count:ze})}},[M,Q,K,W]),z=e.useCallback(f=>{const b=f.key.toLowerCase(),T=U=>{var Ve,ze;if(U.length===0)return;const X=B(U),ge=R(U,b,X);ge!==-1&&(Y(f,U,ge,X),C.current&&Ft(ge,(ze=(Ve=C.current)==null?void 0:Ve.getScrollContainer)==null?void 0:ze.call(Ve)))};if((!r||r.length===0)&&E&&l){Te(f);return}const A=P();A&&T(A)},[n,l,r,E,v,C,M,t,Q,_,o,Y]),de=e.useCallback(f=>{var U,X;const b=P();if(!b||b.length===0)return u(null),null;const T=R(b,f.toLowerCase(),-1);let A=null;return T===-1?u(null):(u(b[T]),A=String(ke(b[T].item,"text",o)),C.current&&Ft(T,(X=(U=C.current)==null?void 0:U.getScrollContainer)==null?void 0:X.call(U))),A},[P,R,u,C]),xe=f=>f==="ArrowDown"||f==="ArrowUp"||f==="PageUp"||f==="PageDown"||f==="Home"||f==="End",je=e.useCallback((f,b,T)=>{if(d){const U=b.findIndex(X=>String(ke(X.item,"value",o))===String(ke(d.item,"value",o)));return u(null),U}const A=b.length;switch(f){case"ArrowDown":return j(b,T,1);case"ArrowUp":return j(b,T,-1);case"PageDown":{const U=T!==-1?T:0,X=Math.max(0,Math.min(A-1,U+10));return D(b,X)}case"PageUp":{const U=T!==-1?T:A-1,X=Math.max(0,Math.min(A-1,U-10));return D(b,X)}case"Home":return L(b,!1);case"End":return L(b,!0);default:return T}},[j,D,L,ke,d]),Te=f=>{E==null||E().then(b=>{if(!b||b.length===0)return;const T=v(b);ce(f,T,f.key)})},ce=e.useCallback((f,b,T)=>{var X,ge;if(b.length===0)return;const A=B(b),U=je(T,b,A);U!==A&&U>=0&&U<b.length&&(Y(f,b,U,A),C.current&&Ft(U,(ge=(X=C.current)==null?void 0:X.getScrollContainer)==null?void 0:ge.call(X)))},[n,M,je,Q,_,o,Y]),F=(f,b)=>{b?(g(f),H(!0),f.preventDefault()):m(f),H(!0)};return{keyActionHandler:e.useCallback(f=>{var T;if(!i)return;if(f.altKey){if(f.key==="ArrowDown"){F(f,!0);return}if(f.key==="ArrowUp"){F(f,!1),f.preventDefault();return}}if(f.key===" "){F(f,!0);return}else if(f.key==="Enter")if(f.preventDefault(),C!=null&&C.current){const A=P();if(!A)return;let U=B(A);if(d){U=A.findIndex(ge=>String(ke(ge.item,"value",o))===String(ke(d.item,"value",o))),u(null);const X=(T=C.current.externalFilterInputRef)==null?void 0:T.current;X&&X.setSelectionRange(X.value.length,X.value.length)}U&&U>=0&&U<A.length&&Y(f,A,U,U),F(f,!1);return}else{F(f,!0);return}else if(f.key==="Tab"||f.key==="Escape"){if(F(f,!1),f.key==="Tab"){H(!1);return}f.preventDefault(),f.stopPropagation();return}if(f.key.length===1&&!f.ctrlKey&&!f.metaKey&&!f.altKey&&!N){f.preventDefault(),z(f);return}if(xe(f.key)){if(f.preventDefault(),(!r||r.length===0)&&E&&l){Te(f);return}const A=P();A&&ce(f,A,f.key)}},[i,C,g,m,H,r,E,v,ce,n,l,_,F,P,Te,d,u,de]),handleCustomTypeAhead:de,typeAheadMatchedItem:d,setTypeAheadMatchedItem:u}},Hr=({valueTemplate:s,dropdownValue:i,dataSource:t,fields:n,allowObjectBinding:l=!1,onRenderedChange:r})=>{const o=e.useMemo(()=>{if(!s||i==null||!Array.isArray(t)||t.length===0)return null;const x=t[0];return typeof x=="string"||typeof x=="number"||typeof x=="boolean"?new Map(t.map(g=>[g,g])).get(i)??null:t.find(C=>{const g=n.value?fe(n.value,C):C;return l?C===i:g===i||g!=null&&i!=null&&g.toString()===i.toString()})??null},[s,i,t,n,l]);return e.useEffect(()=>{r&&r(o!==null&&!!s)},[r,o,s]),!s||o===null?null:typeof s=="function"?p.jsx(p.Fragment,{children:s(o)}):p.jsx(p.Fragment,{children:s})},Br=e.memo(Hr),Dn=e.forwardRef((s,i)=>{const{id:t=`dropdown_${e.useId()}`,dataSource:n=[],fields:l,value:r,defaultValue:o,placeholder:x,disabled:h,readOnly:M,labelMode:C="Never",size:g=ut.Medium,variant:m=Jn.Standard,className:H,required:y,inputProps:E,clearButton:_,dropdownIcon:J=p.jsx(Qn,{}),loading:W,popupSettings:K,open:N,defaultOpen:S,query:d,sortOrder:u=wt.None,allowObjectBinding:v,customValue:a,itemTemplate:j,headerTemplate:L,footerTemplate:D,groupTemplate:V,noRecordsTemplate:R,onErrorTemplate:Q,virtualization:P,ignoreCase:B,ignoreAccent:Y,filterable:z,filterType:de,debounceDelay:xe,valid:je,validationMessage:Te,validityStyles:ce,skipDisabledItems:F=!0,autofill:me,autoHighlight:f,resizable:b,filterPlaceholder:T,minLength:A=0,maxSuggestions:U,inputValueRenderer:X,onResize:ge,onOpen:Ve,onClose:ze,onDataRequest:De,onDataLoad:Ue,onError:ye,onScroll:bt,onChange:oe,onFilter:ot,onCustomValueSelect:_e,componentClassName:Ie,spanClickable:re,inputClassName:Re,valueTemplate:lt,localeComponentName:ht,ariaLabel:at,forceFilterOnOpen:We,...nt}=s,Ee=e.useMemo(()=>n instanceof Ye,[n]),{dir:it,locale:ft}=Wt(),[qt,jt]=Er({defaultValue:o}),{isPopupOpen:le,textValue:Ae,isSpanFocused:dt,isLoading:Nt,itemData:$e,dropdownValue:Ke,activeIndex:Fe}=qt,{setTextValue:Se,setIsSpanFocused:we,setIsPopupOpen:Tt,setIsLoading:be,setDropdownValue:Ne,setActiveIndex:He,setItemData:Je}=jt,ae=e.useRef(null),Ge=e.useRef(null),Xe=e.useRef(null),ee=e.useRef(null),rt=e.useRef(null),st=e.useRef(!1),pt=e.useRef(null),vt=e.useRef(null),[Lt,zt]=e.useState(1e3),[Ct,c]=e.useState({height:0,width:0}),[k,w]=e.useState(!1),O=e.useMemo(()=>!!(lt&&k),[lt,k]),q=e.useMemo(()=>({value:r,defaultValue:o,placeholder:x,disabled:h,className:H,labelMode:C,size:g,variant:m,required:y,inputProps:E,clearButton:_,loading:W}),[r,o,x,h,H,C,g,m,y,E,_,W]);e.useImperativeHandle(i,()=>({...q,element:ae.current}),[q,ae]);const te=e.useCallback(I=>{c({height:I.height,width:I.width}),ge==null||ge(I)},[ge]),Be=e.useMemo(()=>({enabled:b,handles:["SouthEast"],onResize:te}),[b,te]),{renderResizeHandles:Oe}=Yn(Ge,Be);e.useEffect(()=>{const I=K==null?void 0:K.zIndex;let $=typeof I=="number"&&Number.isFinite(I)?I:1e3;if($===1e3&&Xe.current){const ue=Number(Gn(Xe.current));Number.isFinite(ue)&&($=ue)}zt(Math.max(3,$+1))},[K==null?void 0:K.zIndex,Xe]);const{isInputValid:G}=Ir({dropdownValue:Ke,inputElementRef:ae,required:y,valid:je,validationMessage:Te}),Z=e.useMemo(()=>({text:l==null?void 0:l.text,value:(l==null?void 0:l.value)??"value",disabled:(l==null?void 0:l.disabled)??"disabled",groupBy:l==null?void 0:l.groupBy,htmlAttributes:l==null?void 0:l.htmlAttributes}),[l==null?void 0:l.text,l==null?void 0:l.value,l==null?void 0:l.groupBy,l==null?void 0:l.disabled,l==null?void 0:l.htmlAttributes]),se=e.useMemo(()=>({position:{X:"left",Y:"bottom"},collision:it==="rtl"?{X:$t.Fit,Y:$t.Flip}:{X:$t.Flip,Y:$t.Flip},autoReposition:!0,width:"100%",height:"300px",...K}),[K,it]),{showPopup:ve,hidePopup:ne,setPopupWidth:Pe,setPopupHeight:kt,popupClassNames:Dt}=Or({isPopupOpen:le,open:N,setIsPopupOpen:Tt,setIsSpanFocused:we,spanElementRef:Xe,inputElementRef:ae,popupRef:Ge,onOpen:Ve,onClose:ze,popupWidth:se.width,popupHeight:se.height,className:H}),mt=e.useMemo(()=>{if(P)return{...P,scrollMode:P.scrollMode??Mt.FetchAll}},[P]),It=e.useMemo(()=>{const I=rt.current?rt.current:n;if(!Array.isArray(I)||I.length===0)return[];const $=I.filter(pe=>pe!=null);return $.length===0?[]:Mn($,Z,u,d??new Me).map(pe=>{const he=Z.disabled&&typeof pe=="object"&&fe(Z.disabled,pe)===!0,Ce=typeof pe=="object"&&!!fe("isHeader",pe);return{item:pe,isDisabled:!!he,isHeader:Ce}})},[rt.current,n,Z,u,d]),Qt=e.useCallback(async()=>{if(!Ee||st.current)return null;const I=n;try{be(!0),De==null||De({data:I,query:d??new Me});const $=await I.executeQuery(d??new Me),ue=Array.isArray($==null?void 0:$.result)?$.result:[];return st.current=!0,Ue==null||Ue({data:ue}),be(!1),ue}catch($){return be(!1),ye==null||ye($),null}},[Ee,n,d,be,De,Ue,ye]),Ut=e.useCallback(async()=>{const I=await Qt();if(Array.isArray(I)){const $=I.filter(ue=>ue!=null);return rt.current=$,$}return null},[Qt]);Pr({value:r,defaultValue:o,dataSource:n,dataSourceListItems:It,fields:Z,isValueControlled:r!==void 0,allowObjectBinding:v,dropdownbaseRef:ee,dropdownValue:Ke,setDropdownValue:Ne,setTextValue:Se,setActiveIndex:He,setItemData:Je,prefetchData:Ut,spanClickable:re,customValue:a});const{keyActionHandler:At,handleCustomTypeAhead:Yt,typeAheadMatchedItem:Vt,setTypeAheadMatchedItem:Gt}=$r({isInteractive:!h&&!M,skipDisabledItems:F,activeIndex:Fe,onChange:oe,setActiveIndex:He,isRemoteData:Ee,dataSourceListItems:It,fields:Z,dropdownbaseRef:ee,setTextValue:Se,showPopup:ve,hidePopup:ne,setIsSpanFocused:we,setDropdownValue:Ne,prefetchData:Ut,currentItemData:$e,setItemData:Je,onScroll:bt,virtualization:mt,filterable:z,spanClickable:re}),Rt=e.useCallback(I=>{var ct,yt,xt,Qe,Ot;const $=ae.current?ae.current.value:Ae??"";if(!$)return;const ue=(yt=(ct=ee==null?void 0:ee.current)==null?void 0:ct.getFilteredListData)==null?void 0:yt.call(ct),pe=Array.isArray(ue)&&ue.length>0?ue:(It==null?void 0:It.map(qe=>qe.item))??[],he=pe.find(qe=>String(ke(qe,"text",Z))===$);let Ce=null,Le=null,Ze=null,et="";he&&(Ce=ke(he,"value",Z),Le=he,Ze=Nn(he,pe,Z),et=String(ke(he,"text",Z)),Gt(null)),!he&&a&&(Ce=Le=et=$),!he&&!a&&(Ce=Le=null),Ne(Ce),Je(Le),He(Ze),Se(et),le&&(ne==null||ne()),!(!he&&!a)&&(a&&(_e==null||_e(et)),oe&&oe({event:I,previousItemData:$e,value:re?Ce:ke(Le,"text",Z),itemData:Le}),me&&((Ot=ae.current)==null||Ot.setSelectionRange((xt=ae.current)==null?void 0:xt.value.length,(Qe=ae.current)==null?void 0:Qe.value.length)))},[a,ae,Ae,ee,It,Z,Ne,me,Je,He,Se,_e,oe,$e,ne,le,Gt,re]);e.useEffect(()=>{N===void 0&&S&&(we(!0),ve==null||ve())},[]),e.useEffect(()=>{re&&le&&z&&ee.current&&requestAnimationFrame(()=>{we(!1)})},[le,z,re]),e.useEffect(()=>{var I;N!==void 0&&(Tt(N),we(N),N&&((I=ae.current)==null||I.focus()))},[N,ae,Tt,we]),e.useEffect(()=>{pt.current===null&&(pt.current=JSON.stringify(s.dataSource)??null),vt.current===null&&(vt.current=JSON.stringify(s.fields)??null)},[]),e.useEffect(()=>{(JSON.stringify(s.dataSource)!==pt.current||JSON.stringify(s.fields)!==vt.current)&&(pt.current=JSON.stringify(s.dataSource)??null,vt.current=JSON.stringify(s.fields)??null,rt.current=null,st!=null&&st.current&&(st.current=!1,Ut()),be(!1))},[s.dataSource,s.fields]),e.useEffect(()=>{re&&Ee&&le&&!st.current&&be(!0)},[Ee,le,re,be]);const Fn=e.useCallback(I=>{re||I.button===2||h||M||(we(!le),I.preventDefault(),Ee&&le&&be(!1),le?ne(I):ve(I))},[h,le,Ee,M,re,we,be,ne,ve]),Xt=e.useCallback(I=>{const $=I.target.value;if(Se($),re)return;const ue=I.nativeEvent,pe=!!(ue&&ue.inputType&&ue.inputType.toLowerCase().includes("delete")),he=($==null?void 0:$.length)>=A;if(r!==void 0&&(oe==null||oe({event:I,previousItemData:$e,value:$,itemData:null})),pe&&(Je(null),Ne(null),He(null),he||ne()),!!he){if(le||ve(I.nativeEvent),z)requestAnimationFrame(()=>{var Ce;(Ce=ee.current)==null||Ce.filter([],void 0,I),me&&!pe&&requestAnimationFrame(()=>{var Ze,et;const Le=(et=(Ze=ee==null?void 0:ee.current)==null?void 0:Ze.getFilteredListData)==null?void 0:et.call(Ze);if(ae.current&&Le&&(Le==null?void 0:Le.length)>0){const ct=String(ke(Le[0],"text",Z));Se(ct),requestAnimationFrame(()=>{if(ae.current){const yt=$.length,xt=ct.length;ae.current.setSelectionRange(yt,xt)}})}})});else if(!pe){const Ce=Yt($);me&&Ce&&(Se(Ce),requestAnimationFrame(()=>{if(ae.current){const Le=$.length,Ze=Ce.length;ae.current.setSelectionRange(Le,Ze)}}))}}},[Se,ee,re,z,Yt,le,me,ae,Z,A]),Zt=e.useCallback(()=>{var I,$;if(we(!0),re){const ue=(I=ae.current)==null?void 0:I.value.length;ue&&(($=ae.current)==null||$.setSelectionRange(ue,ue))}},[we,re,ae]),en=e.useCallback(I=>{var pe,he,Ce;if(h)return;const $=I.relatedTarget,ue=!!($&&(Ge!=null&&Ge.current)&&((he=(pe=Ge==null?void 0:Ge.current)==null?void 0:pe.element)!=null&&he.contains($)));!re&&!ue&&Rt(I),(Ce=ae.current)!=null&&Ce.contains($)||we(!1)},[h,ae,we,Rt,re,Ge]),Ln=e.useCallback(I=>{var $;I.preventDefault(),I.stopPropagation(),Se(""),Ne(null),He(null),Je(null),re||(le&&ne(),z&&(($=ee.current)==null||$.filter([],void 0,void 0,I))),oe&&oe({event:I,previousItemData:$e,value:null,itemData:null})},[oe,$e,Se,Ne,He,Je,le]),An=e.useCallback(I=>{if(!re){if(I.key==="Enter"&&Ae&&!$e&&!Vt){Rt(I),I.preventDefault(),I.stopPropagation();return}if(I.key.length===1&&!I.ctrlKey&&!I.metaKey&&!I.altKey&&!z||I.key===" ")return}At(I)},[At,z,re,Rt,Ae,$e,Vt]),tn=e.useCallback(I=>{var pe,he,Ce,Le,Ze,et,ct,yt;const ue=I.target.closest(".sf-list-item");if(ue){const xt=(pe=ue.dataset)==null?void 0:pe.value;if(!ie(xt)){const Qe=(Ce=(he=ee==null?void 0:ee.current)==null?void 0:he.getFormattedValue)==null?void 0:Ce.call(he,xt),Ot=((Le=ee==null?void 0:ee.current)==null?void 0:Le.getTextByValue(Qe))||"";Se==null||Se(Ot),Qe!==void 0&&(Ne==null||Ne(Qe));const qe=(Ze=ee==null?void 0:ee.current)==null?void 0:Ze.getDataByValue(Qe),pn=(ct=(et=ee==null?void 0:ee.current)==null?void 0:et.getFilteredListData)==null?void 0:ct.call(et);if(pn){const gn=pn.findIndex(Hn=>String(ke(Hn,"value",Z))===String(Qe??""));gn>=0&&(He==null||He(gn))}let Pt=Qe;qe!=null&&St(qe)?(Je(qe),Ne(qe),Pt=qe):(Je(qe),Qe!=null&&(Ne(Qe),Pt=Qe)),oe&&Pt!==void 0&&oe({event:I,previousItemData:$e,value:re?Pt:ke(qe,"text",Z),itemData:qe||null})}ne==null||ne(),(yt=ae==null?void 0:ae.current)==null||yt.focus()}},[ne,Se,Ne,ee,ae,Z,He,Je,$e,oe,re]),nn=e.useCallback(I=>{re||be(!0),De==null||De(I)},[be,De,re]),rn=e.useCallback((I,$)=>{if(Ue==null||Ue(I),be(!1),!$){if(Array.isArray(I.data)){const ue=I.data.filter(pe=>pe!=null);rt.current=ue}else rt.current=null;if(st.current=!0,ee.current&&Ke!==null&&Ke!==void 0&&ee.current.getDataByValue(Ke)!==void 0){const pe=ee.current.getTextByValue(Ke);Se(pe)}}},[Ue,be,ee,Ke,Se]),sn=e.useCallback(I=>{be(!1),ye==null||ye(I)},[be,ye]),Et=e.useMemo(()=>!!W&&!le||Nt,[Nt,le,W]),on=e.useMemo(()=>{const I=vn(String(ht),{placeholder:x},ft);return I.setLocale(ft),I.getConstant("placeholder")||x||""},[ft,x,ht]),Vn=e.useMemo(()=>["sf-input-group sf-control sf-dropdown",Ie,Et?"sf-loading":"",h?"sf-disabled":"",it==="rtl"?"sf-rtl":"",M?"sf-readonly":"",C!=="Never"?Xn.FLOATINPUT:"",g===ut.Small?"sf-small":g===ut.Large?"sf-large":"sf-medium",!G&&ce?"sf-error":"",m&&m.toLowerCase()!=="standard"?m.toLowerCase()==="outlined"?"sf-outline":`sf-${m.toLowerCase()}`:"",dt?"sf-input-focus":"",H].filter(Boolean).join(" "),[h,H,it,M,C,g,m,dt,G,ce,Et,Ie]),ln=e.useMemo(()=>[it==="rtl"?"sf-rtl":"",G?"sf-valid-input":"",Re,O?"sf-input-value-template":""].filter(Boolean).join(" "),[it,G,Re,O]),Rn=e.useMemo(()=>[Dt,b?"sf-dropdown-resizable":""].filter(Boolean).join(" "),[Dt]),an=e.useMemo(()=>{const{className:I,...$}=E||{},ue=[I,ln].filter(Boolean).join(" ");return{...$,id:t,className:ue,readOnly:re||M,required:y,disabled:h,value:Ae,defaultValue:void 0}},[E,Ae,ln,t,M,y,h,re]),En=e.useMemo(()=>["sf-input-icon sf-ddl-icon",le?"sf-icon-rotate":"sf-icon-normal"].filter(Boolean).join(" "),[le]),cn=e.useMemo(()=>({"aria-controls":`${t}_listbox`,"aria-activedescendant":le&&Fe!=null?`${t}_option_${Fe}`:void 0,"aria-expanded":N??le}),[Fe,t,N,le]),un=e.useCallback(I=>{const $=String(ke(I,"text",Z)),ue=wr($,Ae);return p.jsx("span",{className:"sf-dd-item",children:ue.map((pe,he)=>pe.highlight?p.jsx("span",{className:"sf-dd-highlight",children:pe.text},he):p.jsx("span",{children:pe.text},he))})},[Z,Ae,de,B,Y]),fn=e.useMemo(()=>f?j??un:j,[f,j,un]),On=e.useCallback(I=>{if(!re||I.button===2||h)return;const $=I.target instanceof Element?I.target:null;$&&$.parentElement&&$.parentElement.matches(".sf-clear-icon")||(we(!le),I.preventDefault(),Nt&&!Ee&&!W&&be(!1),M||(le?ne(I):ve(I)),Ee&&le&&be(!1))},[be,h,M,le,Ee,re,we]),Pn=e.useCallback(()=>p.jsx(Br,{valueTemplate:lt,dropdownValue:Ke,dataSource:Array.isArray(n)?n:[],fields:Z,allowObjectBinding:v,onRenderedChange:w}),[lt,Ke,n,Z,v]),$n=e.useMemo(()=>p.jsx(Tn,{id:t,ref:ee,dataSource:n,itemData:$e,fields:Z,query:d,size:g,sortOrder:u,allowObjectBinding:v,onItemClick:tn,itemTemplate:fn,headerTemplate:L,footerTemplate:D,groupTemplate:V,noRecordsTemplate:R,value:Ke,onErrorTemplate:Q,onError:sn,onDataRequest:nn,onDataLoad:rn,activeIndex:Fe,remoteCacheRef:rt,virtualization:mt,onScroll:bt,onFilter:ot,externalFilterInputRef:re?void 0:ae,ignoreAccent:Y,ignoreCase:B,filterType:de,debounceDelay:xe,focusedItem:Vt,resizable:b,onResize:ge,isDropdownFiltering:z,filterPlaceholder:T,keyActionHandler:re?At:void 0,maxSuggestions:U,forceFilterOnOpen:We},"dropdown"),[ee,n,Z,d,g,u,tn,fn,L,D,V,R,Ke,sn,Q,nn,rn,t,Fe,rt,bt,$e,v,ae,Y,B,de,xe,Vt,ot,ge,b,z,T,re,At,mt,U,We]),dn=e.useMemo(()=>p.jsx(Cn,{id:t,ref:ae,type:"text",role:"combobox","aria-haspopup":"listbox","aria-label":at,"aria-autocomplete":"list","aria-disabled":h,"aria-readonly":M,placeholder:on,floatLabelType:C,required:y,onChange:Xt,onFocus:Zt,onBlur:en,...cn,...an}),[t,ae,at,h,M,on,C,b,Xt,Zt,en,cn,an]);return p.jsxs(p.Fragment,{children:[p.jsxs("span",{ref:Xe,className:Vn,tabIndex:-1,onKeyDown:An,onMouseDown:On,...nt,children:[re&&lt&&p.jsx("span",{className:`sf-input-value ${O?"sf-content":"sf-display-none"}`,children:Pn()}),!X&&dn,X&&p.jsx("span",{className:"sf-input-value sf-content",children:X(dn)}),C!=="Never"&&Zn(C,dt,Ae||"",x,t),_&&kn(Ae&&(dt||le)?Ae:"",Ln),!Et&&J&&p.jsxs("span",{onMouseDown:Fn,"aria-hidden":"true",className:En,children:[" ",J," "]}),Et&&p.jsx(Kt,{size:g===ut.Small?"16px":"20px",visible:!0})]}),le&&typeof document<"u"&&Bn.createPortal(p.jsxs(er,{ref:Ge,className:Rn,id:`${t}_popup`,relateTo:Xe.current,width:Ct.width?Ct.width:Pe(),height:"auto",position:se.position,zIndex:Lt,collision:se.collision,open:le,autoReposition:se.autoReposition,animation:{show:{name:"FadeIn",duration:100},hide:{name:"FadeOut",duration:100}},offsetX:se.offsetX,offsetY:se.offsetY,style:{maxHeight:Ct.height?Ct.height:kt()},children:[$n,b&&Oe(p.jsx(tr,{fill:"currentColor"}))]}),document.body)]})});e.memo(Dn);const qr=e.forwardRef((s,i)=>{const{dataSource:t,query:n,fields:l,value:r,placeholder:o="",id:x=`dropdownlist_${e.useId()}`,disabled:h=!1,readOnly:M=!1,popupSettings:C={},allowObjectBinding:g=!1,labelMode:m,open:H,defaultOpen:y,skipDisabledItems:E,defaultValue:_,ignoreCase:J=!0,ignoreAccent:W=!1,filterable:K=!1,filterType:N="StartsWith",filterPlaceholder:S="",debounceDelay:d=0,sortOrder:u,loading:v=!1,size:a,variant:j,inputProps:L={},itemTemplate:D,headerTemplate:V,footerTemplate:R,groupTemplate:Q,valueTemplate:P,noRecordsTemplate:B,clearButton:Y=!1,dropdownIcon:z,valid:de,validationMessage:xe="",validityStyles:je=!0,required:Te,className:ce,virtualization:F,onChange:me,onOpen:f,onClose:b,onError:T,onFilter:A,onDataRequest:U,onDataLoad:X,onScroll:ge,onErrorTemplate:Ve,...ze}=s;e.useEffect(()=>{Sn("dropdownlist")},[]);const De=e.useRef(null),Ue=e.useMemo(()=>({dataSource:t,query:n,fields:l,value:r,placeholder:o,id:x,popupSettings:C,allowObjectBinding:g,itemTemplate:D,headerTemplate:V,valueTemplate:P,groupTemplate:Q,noRecordsTemplate:B,footerTemplate:R,labelMode:m,open:H,skipDisabledItems:E,ignoreCase:J,ignoreAccent:W,filterable:K,filterType:N,filterPlaceholder:S,sortOrder:u,clearButton:Y,dropdownIcon:z,loading:v,size:a,variant:j}),[t,l,r,o,x,C,g]);return e.useImperativeHandle(i,()=>{var ye;return{...Ue,element:(ye=De.current)==null?void 0:ye.element}},[Ue,De]),p.jsx(Dn,{...ze,id:x,ref:De,componentClassName:"sf-ddl",spanClickable:!0,inputClassName:"sf-dropdown-list",localeComponentName:"dropdownList",ariaLabel:"dropdownlist",dataSource:t,query:n,fields:l,value:r,placeholder:o,disabled:h,readOnly:M,popupSettings:C,allowObjectBinding:g,labelMode:m,open:H,defaultOpen:y,skipDisabledItems:E,defaultValue:_,ignoreCase:J,ignoreAccent:W,filterable:K,filterType:N,filterPlaceholder:S,debounceDelay:d,sortOrder:u,loading:v,size:a,variant:j,inputProps:L,itemTemplate:D,headerTemplate:V,footerTemplate:R,groupTemplate:Q,valueTemplate:P,noRecordsTemplate:B,clearButton:Y,dropdownIcon:z,valid:de,validationMessage:xe,validityStyles:je,required:Te,className:ce,virtualization:F,onChange:me,onOpen:f,onClose:b,onError:T,onFilter:A,onDataRequest:U,onDataLoad:X,onScroll:ge,onErrorTemplate:Ve})});e.memo(qr);export{qr as D};
